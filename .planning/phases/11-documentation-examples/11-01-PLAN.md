---
phase: 11-documentation-examples
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
  - rig-cli/src/lib.rs
autonomous: true

must_haves:
  truths:
    - "Developer understands what CLI agents are before seeing code"
    - "Developer can copy-paste quick start and have working code"
    - "Developer knows which adapter to use from comparison table"
  artifacts:
    - path: "README.md"
      provides: "Project overview with concept-first learning path"
      contains: "## What are CLI Agents?"
    - path: "rig-cli/src/lib.rs"
      provides: "Crate-level rustdoc with API reference"
      contains: "//! ## Two Execution Paths"
  key_links:
    - from: "README.md"
      to: "examples/"
      via: "example links section"
      pattern: "examples/.*\\.rs"
---

<objective>
Rewrite README.md and enhance rig-cli crate-level documentation to provide a complete learning path for developers.

Purpose: Developers approaching the library need concept-first explanation (what are CLI agents, why MCP matters) before diving into code. The README serves marketing/discovery needs while rustdoc serves API reference needs.

Output: README.md with Concept -> Quick start -> Features -> Examples -> Adapter comparison structure. Enhanced lib.rs with comprehensive crate overview.
</objective>

<execution_context>
@/home/pnod/.claude/get-shit-done/workflows/execute-plan.md
@/home/pnod/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/11-documentation-examples/11-CONTEXT.md
@.planning/phases/11-documentation-examples/11-RESEARCH.md
@rig-cli/src/lib.rs
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite README.md with concept-first structure</name>
  <files>README.md</files>
  <action>
Replace current README.md (which references obsolete "rig-provider" architecture) with new structure:

1. **Header**: `# rig-cli` - one-sentence value prop

2. **What are CLI Agents?** section:
   - Explain CLI agents (Claude Code, Codex, OpenCode) vs cloud APIs
   - Why MCP (Model Context Protocol) matters for structured extraction
   - When to use CLI agents vs direct API calls

3. **Quick Start** section:
   - Minimal working example (~10 lines)
   - Shows `rig_cli::claude::Client::new()` -> `agent()` -> `prompt()`
   - Uses `cargo add rig-cli` instruction

4. **Features** section as table:
   | Feature | Description |
   | Direct CLI execution | Simple prompts via `client.agent()` |
   | MCP-enforced extraction | Structured output via `client.mcp_agent()` |
   | Streaming support | Real-time event streaming |
   | Payload injection | Context data attachment |
   | Multi-adapter support | Claude, Codex, OpenCode |

5. **Two Execution Paths** section:
   - Explain `agent()` vs `mcp_agent()` decision
   - Table showing when to use each

6. **Adapter Comparison** table:
   | Feature | Claude | Codex | OpenCode |
   | MCP support | Yes | Yes | Yes |
   | Streaming events | Full (ToolCall/ToolResult) | Text/Error only | Text/Error only |
   | Containment flags | --disable-builtin-tools, cwd | --sandbox, cwd | cwd only |
   | System prompt | --system-prompt | system_prompt field | prompt field |

7. **Examples** section:
   - Link to each example in `rig-cli/examples/` with one-line description
   - (Examples will be created in later plans)

8. **Documentation** section:
   - Link to docs.rs for API reference
   - Link to this repo for examples

Do NOT include:
- References to "rig-provider" crate (internal implementation)
- Old workspace structure diagram
- Links to obsolete documentation artifacts
  </action>
  <verify>
- `cat README.md | grep -q "What are CLI Agents"` returns 0
- `cat README.md | grep -q "Adapter Comparison"` returns 0
- `cat README.md | grep -c "rig-provider"` returns 0 (no old references)
  </verify>
  <done>README.md contains concept-first documentation with all required sections, no obsolete references</done>
</task>

<task type="auto">
  <name>Task 2: Enhance rig-cli crate-level rustdoc</name>
  <files>rig-cli/src/lib.rs</files>
  <action>
Update the crate-level doc comment (`//!` at top of lib.rs) to provide comprehensive API reference:

1. Keep existing structure but enhance:
   - **Summary**: One-sentence description (keep current)
   - **Quick Start**: Keep existing code example, ensure it compiles with `no_run`

2. Add **Feature Flags** section documenting:
   - `claude` (default): Claude Code provider
   - `codex` (default): Codex provider
   - `opencode` (default): OpenCode provider
   - `debug-output` (opt-in): Include raw CLI output in errors

3. Add **Module Overview** section:
   | Module | Purpose |
   | `claude` | Claude Code provider with CompletionModel |
   | `codex` | Codex provider with CompletionModel |
   | `opencode` | OpenCode provider with CompletionModel |
   | `extraction` | MCP extraction types (re-exported from rig-mcp-server) |
   | `tools` | MCP tool types (re-exported from rig-mcp-server) |
   | `prelude` | Common imports |

4. Enhance **Two Execution Paths** section with decision tree:
   - Need structured output? -> `mcp_agent()`
   - Simple prompt/chat? -> `agent()`

5. Update code examples to use `?` operator (not `unwrap()`) per Rust API guidelines

Preserve:
- `#![deny(missing_docs)]` at crate root
- Existing module-level doc comments
- Existing re-exports
  </action>
  <verify>
- `cargo doc -p rig-cli --no-deps` succeeds without warnings
- `cargo test -p rig-cli --doc` passes (doc examples compile)
  </verify>
  <done>rig-cli crate-level docs provide comprehensive API reference with module overview, feature flags, and decision guidance</done>
</task>

</tasks>

<verification>
1. `cargo doc -p rig-cli --no-deps --open` renders correctly
2. README.md renders correctly on GitHub (check markdown preview)
3. No references to obsolete architecture remain
4. All code examples in both files use `?` operator
</verification>

<success_criteria>
- README.md has 7 required sections (What are CLI Agents?, Quick Start, Features, Two Execution Paths, Adapter Comparison, Examples, Documentation)
- rig-cli/src/lib.rs doc examples pass `cargo test --doc`
- Zero doc build warnings
- No references to "rig-provider" in README.md
</success_criteria>

<output>
After completion, create `.planning/phases/11-documentation-examples/11-01-SUMMARY.md`
</output>
